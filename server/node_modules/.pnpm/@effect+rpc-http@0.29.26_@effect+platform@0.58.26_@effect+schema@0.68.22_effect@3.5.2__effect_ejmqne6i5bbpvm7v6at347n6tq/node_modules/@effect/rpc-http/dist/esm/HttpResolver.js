/**
 * @since 1.0.0
 */
import * as Body from "@effect/platform/HttpBody";
import * as Client from "@effect/platform/HttpClient";
import * as ClientRequest from "@effect/platform/HttpClientRequest";
import * as Resolver from "@effect/rpc/Resolver";
import * as Chunk from "effect/Chunk";
import * as Effect from "effect/Effect";
import * as Schedule from "effect/Schedule";
import * as Stream from "effect/Stream";
/**
 * @category constructors
 * @since 1.0.0
 */
export const make = client => Resolver.make(requests => client(ClientRequest.post("", {
  body: Body.unsafeJson(requests)
})).pipe(Effect.map(_ => _.stream.pipe(Stream.decodeText(), Stream.splitLines, Stream.map(_ => Chunk.unsafeFromArray(JSON.parse(_))), Stream.flattenChunks)), Stream.unwrapScoped))();
/**
 * @category constructors
 * @since 1.0.0
 */
export const makeClient = baseUrl => Resolver.toClient(make(Client.fetchOk.pipe(Client.mapRequest(ClientRequest.prependUrl(baseUrl)), Client.retry(Schedule.exponential(50).pipe(Schedule.intersect(Schedule.recurs(5)))))));
//# sourceMappingURL=HttpResolver.js.map